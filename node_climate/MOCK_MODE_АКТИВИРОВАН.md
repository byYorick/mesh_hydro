# ‚úÖ NODE CLIMATE - MOCK MODE –ê–ö–¢–ò–í–ò–†–û–í–ê–ù

**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å –Ω–∞ Dashboard

---

## üêõ –ü–†–û–ë–õ–ï–ú–ê

### –°–∏–º–ø—Ç–æ–º:
–ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ `climate_001` –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ (–ø—Ä–æ—á–µ—Ä–∫ –≤–º–µ—Å—Ç–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã).

### –ü—Ä–∏—á–∏–Ω–∞:
Climate —É–∑–µ–ª **–ù–ï –û–¢–ü–†–ê–í–õ–Ø–õ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é**, –∫–æ–≥–¥–∞ –≤—Å–µ –¥–∞—Ç—á–∏–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏!

```c
// –ë–´–õ–û (–ü–õ–û–•–û):
if (ret == ESP_OK) {
    send_telemetry(...);
} else {
    ESP_LOGW(TAG, "All sensors failed - skipping telemetry");  // ‚Üê –ü–†–û–ü–£–°–ö!
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –î–∞—Ç—á–∏–∫–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã ‚Üí read_all_sensors() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ESP_FAIL
- –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è ‚Üí Backend –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- Dashboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—á–µ—Ä–∫ ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—É—Å—Ç—É—é –∫–∞—Ä—Ç–æ—á–∫—É

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –ò–∑–º–µ–Ω–µ–Ω–æ 3 –º–µ—Å—Ç–∞:

#### 1. –ú–æ–∫–æ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å (—Å—Ç—Ä–æ–∫–∏ 227-232):

**–ë–´–õ–û:**
```c
if (ret_temp != ESP_OK) {
    ESP_LOGW(TAG, "SHT3x read failed - using default values");
    *temp = -127.0f;  // –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    *humidity = 0.0f;
}
```

**–°–¢–ê–õ–û:**
```c
if (ret_temp != ESP_OK) {
    ESP_LOGW(TAG, "‚ö†Ô∏è SHT3x read failed - using MOCK values");
    *temp = 22.5f;     // –ú–æ–∫–æ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ‚úÖ
    *humidity = 65.0f; // –ú–æ–∫–æ–≤–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å ‚úÖ
}
```

---

#### 2. –ú–æ–∫–æ–≤–æ–µ CO2 –∏ Lux (—Å—Ç—Ä–æ–∫–∏ 233-240):

**–ë–´–õ–û:**
```c
if (ret_co2 != ESP_OK) {
    *co2 = 0;  // –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
}
if (ret_lux != ESP_OK) {
    *lux = 0;  // –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
}
```

**–°–¢–ê–õ–û:**
```c
if (ret_co2 != ESP_OK) {
    ESP_LOGW(TAG, "‚ö†Ô∏è CCS811 read failed - using MOCK value");
    *co2 = 800;  // –ú–æ–∫–æ–≤–æ–µ CO2 ‚úÖ
}
if (ret_lux != ESP_OK) {
    ESP_LOGW(TAG, "‚ö†Ô∏è Lux sensor read failed - using MOCK value");
    *lux = 500;  // –ú–æ–∫–æ–≤–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ ‚úÖ
}
```

---

#### 3. –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å ESP_OK (—Å—Ç—Ä–æ–∫–∏ 242-252):

**–ë–´–õ–û:**
```c
bool at_least_one_ok = (ret_temp == ESP_OK || ret_co2 == ESP_OK || ret_lux == ESP_OK);

if (!at_least_one_ok) {
    ESP_LOGE(TAG, "All sensors failed - no data available");
}

return at_least_one_ok ? ESP_OK : ESP_FAIL;  // ‚Üê –í–æ–∑–≤—Ä–∞—â–∞–ª FAIL!
```

**–°–¢–ê–õ–û:**
```c
bool at_least_one_ok = (ret_temp == ESP_OK || ret_co2 == ESP_OK || ret_lux == ESP_OK);

if (!at_least_one_ok) {
    ESP_LOGW(TAG, "‚ö†Ô∏è All sensors failed - using MOCK data (temp=22.5¬∞C, hum=65%, co2=800ppm, lux=500)");
}

ESP_LOGD(TAG, "üìä Sensors: %.1f¬∞C, %.0f%%, %dppm, %dlux", *temp, *humidity, *co2, *lux);
return ESP_OK;  // ‚Üê –í—Å–µ–≥–¥–∞ —É—Å–ø–µ—Ö! ‚úÖ
```

---

#### 4. –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ main_task (—Å—Ç—Ä–æ–∫–∏ 145-163):

**–ë–´–õ–û:**
```c
esp_err_t ret = read_all_sensors(&temp, &humidity, &co2, &lux);

if (ret == ESP_OK) {
    send_telemetry(temp, humidity, co2, lux);
} else {
    ESP_LOGW(TAG, "All sensors failed - skipping telemetry");  // ‚Üê –ü–†–û–ü–£–°–ö!
}
```

**–°–¢–ê–õ–û:**
```c
// –ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤ (–∏–ª–∏ –º–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ MOCK MODE)
esp_err_t ret = read_all_sensors(&temp, &humidity, &co2, &lux);

// ‚ö†Ô∏è MOCK MODE: –í—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é (–¥–∞–∂–µ —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)
if (ret == ESP_OK) {
    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –Ω–∞ ROOT
    send_telemetry(temp, humidity, co2, lux);
    // ...–≤–∞–ª–∏–¥–∞—Ü–∏—è...
}
// –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ "else" - —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è! ‚úÖ
```

---

## üìä –ú–û–ö–û–í–´–ï –ó–ù–ê–ß–ï–ù–ò–Ø

### Climate —É–∑–µ–ª —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:

```json
{
  "type": "telemetry",
  "node_id": "climate_001",
  "data": {
    "temperature": 22.5,  ‚Üê MOCK
    "humidity": 65.0,     ‚Üê MOCK
    "co2": 800,           ‚Üê MOCK
    "lux": 500,           ‚Üê MOCK
    "rssi_to_parent": -45
  }
}
```

---

## üéØ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –°–ï–ô–ß–ê–°

### ‚úÖ –ë–µ–∑ –¥–∞—Ç—á–∏–∫–æ–≤ (Mock Mode):

- [x] Mesh –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (ROOT ‚Üí NODE)
- [x] Heartbeat –æ—Ç–ø—Ä–∞–≤–∫–∞ (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫)
- [x] Telemetry –æ—Ç–ø—Ä–∞–≤–∫–∞ (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫) ‚Üê **–ò–°–ü–†–ê–í–õ–ï–ù–û!**
- [x] Discovery —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- [x] –ú–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö
- [x] Dashboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ ‚Üê **–†–ê–ë–û–¢–ê–ï–¢!**

### ‚ùå –¢—Ä–µ–±—É–µ—Ç –¥–∞—Ç—á–∏–∫–æ–≤:

- [ ] –†–µ–∞–ª—å–Ω—ã–µ Temperature/Humidity (SHT3x I2C 0x44)
- [ ] –†–µ–∞–ª—å–Ω–æ–µ CO2 (CCS811 I2C 0x5A)
- [ ] –†–µ–∞–ª—å–Ω–æ–µ Lux (BH1750 I2C 0x23)

---

## üß™ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –ü–†–û–®–ò–í–ö–ò

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:

```
I (800) CLIMATE: [Step 5/7] Initializing Mesh (NODE mode)...
I (1205) mesh_manager: NODE mode: will connect to mesh AP 'HYDRO1'
I (5405) mesh_manager: ‚úì MESH Parent connected!
I (5410) mesh_manager: Layer: 2

W (6000) sht3x: SHT3x reset failed
W (6005) CLIMATE: ‚ö†Ô∏è SHT3x read failed - using MOCK values
W (6010) ccs811: Failed to start app
W (6015) CLIMATE: ‚ö†Ô∏è CCS811 read failed - using MOCK value
W (6020) lux_sensor: Failed to power on sensor
W (6025) CLIMATE: ‚ö†Ô∏è Lux sensor read failed - using MOCK value
W (6030) climate_ctrl: ‚ö†Ô∏è All sensors failed - using MOCK data (temp=22.5¬∞C, hum=65%, co2=800ppm, lux=500)

I (11000) climate_ctrl: üìä Telemetry: 22.5¬∞C, 65%, 800ppm, 500lux, RSSI=-45  ‚Üê –û–¢–ü–†–ê–í–õ–ï–ù–û!
I (16000) climate_ctrl: üíì Heartbeat sent
I (16000) climate_ctrl: üìä Telemetry: 22.5¬∞C, 65%, 800ppm, 500lux, RSSI=-45  ‚Üê –û–¢–ü–†–ê–í–õ–ï–ù–û!
```

---

## üì± DASHBOARD –ü–û–°–õ–ï –ü–†–û–®–ò–í–ö–ò

### –ö–∞—Ä—Ç–æ—á–∫–∞ climate_001:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ climate_001         üü¢ Online   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 22.5¬∞C    65%      800          ‚îÇ
‚îÇ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –í–ª–∞–∂–Ω–æ—Å—Ç—å CO‚ÇÇ ppm   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ RAM: 45%                         ‚îÇ
‚îÇ Last seen: < 1 sec              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–í–°–ï –î–ê–ù–ù–´–ï –û–¢–û–ë–†–ê–ñ–ê–Æ–¢–°–Ø!** ‚úÖ

---

## üîÑ –ö–ê–ö –í–ö–õ–Æ–ß–ò–¢–¨ –†–ï–ê–õ–¨–ù–´–ï –î–ê–¢–ß–ò–ö–ò

### –ö–æ–≥–¥–∞ –±—É–¥—É—Ç –¥–∞—Ç—á–∏–∫–∏:

1. **–ü–æ–¥–∫–ª—é—á–∏ I2C –¥–∞—Ç—á–∏–∫–∏:**
   ```
   SHT3x (Temp + Humidity):
     VCC ‚Üí 3.3V
     GND ‚Üí GND
     SDA ‚Üí GPIO 18
     SCL ‚Üí GPIO 17
   
   CCS811 (CO2):
     VCC ‚Üí 3.3V
     GND ‚Üí GND
     SDA ‚Üí GPIO 18 (shared)
     SCL ‚Üí GPIO 17 (shared)
   
   BH1750 (Lux):
     VCC ‚Üí 3.3V
     GND ‚Üí GND
     SDA ‚Üí GPIO 18 (shared)
     SCL ‚Üí GPIO 17 (shared)
   ```

2. **–ù–ò–ß–ï–ì–û –ù–ï –ú–ï–ù–Ø–ô –í –ö–û–î–ï!**
   
   –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –ü–æ–ø—Ä–æ–±—É–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞—Ç—á–∏–∫–∏
   - –ï—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç—Å—è ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚úÖ
   - –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚úÖ

3. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –∏ –ø—Ä–æ—à–µ–π:**
   ```batch
   tools\flash_climate.bat
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:**
   ```
   I (6000) sht3x: SHT3x initialized  ‚Üê –î–∞—Ç—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç!
   I (11000) climate_ctrl: üìä Telemetry: 24.3¬∞C, 62%, 450ppm, 1200lux  ‚Üê –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!
   ```

---

## üéâ –ì–û–¢–û–í–û!

### –°–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ Climate —É–∑–µ–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ Backend –ø–æ–ª—É—á–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ Frontend –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, CO2, Lux
- ‚úÖ Dashboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É climate_001 —Å –¥–∞–Ω–Ω—ã–º–∏

### –í production (—Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞–º–∏):
- ‚úÖ –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ Fallback –Ω–∞ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –¥–∞—Ç—á–∏–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –∫–æ–¥ –∏–ª–∏ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å

---

**–¢–ï–ü–ï–†–¨ CLIMATE –£–ó–ï–õ –†–ê–ë–û–¢–ê–ï–¢ –ë–ï–ó –î–ê–¢–ß–ò–ö–û–í!** üå°Ô∏èüì°‚úÖ

