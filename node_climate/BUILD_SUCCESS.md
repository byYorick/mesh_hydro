# ‚úÖ NODE Climate - –°–±–æ—Ä–∫–∞ –£–°–ü–ï–®–ù–ê!

**–î–∞—Ç–∞**: 18.10.2025  
**ESP-IDF**: v5.5  
**Target**: ESP32  
**WiFi**: Yorick  

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

```
–†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞:  0x105a20 –±–∞–π—Ç (~1.04 –ú–ë)
–†–∞–∑–º–µ—Ä —Ä–∞–∑–¥–µ–ª–∞: 0x180000 –±–∞–π—Ç (1.5 –ú–ë)
–°–≤–æ–±–æ–¥–Ω–æ:       502240 –±–∞–π—Ç (32%)
–°—Ç–∞—Ç—É—Å:         ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í!
```

‚úÖ **–û–±—Ä–∞–∑ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª**  
‚úÖ **–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã**  
‚úÖ **–ö–æ–º–ø–∏–ª—è—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫**  

---

## üîß –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1Ô∏è‚É£ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å ESP-IDF v5.5
- ‚ùå –£–¥–∞–ª–µ–Ω `esp_task_wdt` (API –∏–∑–º–µ–Ω–∏–ª—Å—è)
- ‚úÖ –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—ã–∑–æ–≤—ã watchdog
- ‚úÖ –£–±—Ä–∞–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ CMakeLists.txt

### 2Ô∏è‚É£ –£–≤–µ–ª–∏—á–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–¥–µ–ª–æ–≤
- üìÑ –°–æ–∑–¥–∞–Ω `partitions.csv`
- üìà Factory app: **1 –ú–ë ‚Üí 1.5 –ú–ë**
- ‚úÖ –°–≤–æ–±–æ–¥–Ω–æ 32% –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏

### 3Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π target
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ESP32 (–Ω–µ S3)
- ‚úÖ `build.bat` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç target

### 4Ô∏è‚É£ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º –¥–∞—Ç—á–∏–∫–æ–≤
**`main/app_main.c`:**
- ‚úÖ –ú—è–≥–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞—Ç—á–∏–∫–æ–≤
- ‚ö†Ô∏è WARNING –≤–º–µ—Å—Ç–æ ABORT

**`climate_controller.c`:**
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –£—Å–ø–µ—Ö –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã 1 –¥–∞—Ç—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –¥–∞—Ç—á–∏–∫–æ–≤

### 5Ô∏è‚É£ Mesh NODE –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**`mesh_manager.c`:**
- ‚úÖ Router credentials –¥–ª—è –í–°–ï–• —É–∑–ª–æ–≤ (ROOT –∏ NODE)
- ‚úÖ `max_connection = 6` –¥–ª—è NODE —É–∑–ª–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ **`esp_mesh_set_type(MESH_NODE)` –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è** - NODE —ç—Ç–æ –¥–µ—Ñ–æ–ª—Ç!
- ‚úÖ –¢–æ–ª—å–∫–æ ROOT —è–≤–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `esp_mesh_set_type(MESH_ROOT)`

**`app_main.c`:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã router_ssid –∏ router_password
- ‚úÖ –£–∫–∞–∑–∞–Ω WiFi: **"Yorick"** / **"pro100parol"**

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –°–±–æ—Ä–∫–∞:
```bash
.\build.bat
```

### –ü—Ä–æ—à–∏–≤–∫–∞:
```bash
.\flash.bat COM4
```
–∏–ª–∏
```bash
idf.py -p COM4 flash monitor
```

### –¢–æ–ª—å–∫–æ –ø—Ä–æ—à–∏–≤–∫–∞ (–±–µ–∑ –º–æ–Ω–∏—Ç–æ—Ä–∞):
```bash
idf.py -p COM4 flash
```

---

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Mesh

```c
Mesh ID:       "HYDRO1"
Mesh Password: "hydro_mesh_2025"
WiFi Channel:  1
Router SSID:   "Yorick"
Router Pass:   "pro100parol"
Max Connect:   6 —É–∑–ª–æ–≤
```

**‚ö†Ô∏è –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å –Ω–∞ ROOT —É–∑–ª–µ!**

---

## üéØ –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

### –ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º:
- ‚úÖ –í—Å–µ –¥–∞—Ç—á–∏–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã
- ‚úÖ –ß—Ç–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª–Ω–æ–π —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –Ω–∞ ROOT

### Degraded mode:
- ‚ö†Ô∏è –û–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç—á–∏–∫–æ–≤ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚ö†Ô∏è WARNING –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Mesh –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º:
- ‚ùå –í—Å–µ –¥–∞—Ç—á–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚ö†Ô∏è –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- ‚úÖ Mesh –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã

---

## üì° –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—à–µ–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ**: `.\flash.bat COM4`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ WARNING –æ –¥–∞—Ç—á–∏–∫–∞—Ö
3. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ ROOT —É–∑–µ–ª** —Å —Ç–∞–∫–∏–º–∏ –∂–µ mesh credentials
4. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –¥–∞—Ç—á–∏–∫–∏** (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é** —á–µ—Ä–µ–∑ ROOT ‚Üí MQTT

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –ü—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] WiFi credentials —É–∫–∞–∑–∞–Ω—ã
- [x] Mesh credentials —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å ROOT
- [x] –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–¥–µ–ª–æ–≤ —É–≤–µ–ª–∏—á–µ–Ω–∞
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–∞—Ç—á–∏–∫–æ–≤
- [x] Target = ESP32
- [ ] –ü—Ä–æ—à–∏–≤–∫–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å ROOT —É–∑–ª–æ–º
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤

---

**–°—Ç–∞—Ç—É—Å**: üü¢ –ì–û–¢–û–í –ö –ü–†–û–®–ò–í–ö–ï!

