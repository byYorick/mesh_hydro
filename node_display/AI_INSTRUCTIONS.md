# ü§ñ AI INSTRUCTIONS - NODE Display

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —É–∑–ª–∞

**NODE Display (ESP32-S3 #2)** - TFT –¥–∏—Å–ø–ª–µ–π —Å LVGL UI

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- üì∫ TFT –¥–∏—Å–ø–ª–µ–π 240x320 (ILI9341 —á–µ—Ä–µ–∑ SPI)
- üé® LVGL 8.x UI framework
- üîÑ –†–æ—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä (–Ω–∞–≤–∏–≥–∞—Ü–∏—è)
- üìä –ü–æ–∫–∞–∑ –¥–∞–Ω–Ω—ã—Ö –í–°–ï–• —É–∑–ª–æ–≤ mesh-—Å–µ—Ç–∏
- üîç –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –æ—Ç ROOT —á–µ—Ä–µ–∑ mesh
- üìà –ì—Ä–∞—Ñ–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:
- ‚úÖ **–ù–ï–¢ –¥–∞—Ç—á–∏–∫–æ–≤** - —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- ‚úÖ **–ù–ï–¢ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π** - —Ç–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ **–¢—Ä–µ–±—É–µ—Ç PSRAM** - LVGL –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ mesh (–Ω–µ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç —É–∑–ª–æ–≤)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
NODE Display (ESP32-S3 #2 —Å PSRAM)
‚îÇ
‚îú‚îÄ‚îÄ LCD ILI9341 (SPI)
‚îÇ   ‚îú‚îÄ‚îÄ 240x320 –ø–∏–∫—Å–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ 16-bit color
‚îÇ   ‚îî‚îÄ‚îÄ Backlight PWM
‚îÇ
‚îú‚îÄ‚îÄ LVGL UI
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard —ç–∫—Ä–∞–Ω (–≥–ª–∞–≤–Ω—ã–π)
‚îÇ   ‚îú‚îÄ‚îÄ Node Detail —ç–∫—Ä–∞–Ω (–¥–µ—Ç–∞–ª–∏ —É–∑–ª–∞)
‚îÇ   ‚îú‚îÄ‚îÄ Node List —ç–∫—Ä–∞–Ω (—Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ System Menu —ç–∫—Ä–∞–Ω (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îÇ
‚îú‚îÄ‚îÄ Encoder Input
‚îÇ   ‚îú‚îÄ‚îÄ CLK, DT (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
‚îÇ   ‚îú‚îÄ‚îÄ SW (–∫–Ω–æ–ø–∫–∞)
‚îÇ   ‚îî‚îÄ‚îÄ Debouncing
‚îÇ
‚îî‚îÄ‚îÄ Display Controller
    ‚îú‚îÄ‚îÄ –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –æ—Ç ROOT
    ‚îú‚îÄ‚îÄ –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤
    ‚îî‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
```

---

## üîå –†–∞—Å–ø–∏–Ω–æ–≤–∫–∞

| GPIO | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç |
|------|------------|-----------|
| **LCD (SPI):** | | |
| 11 | LCD MOSI | ILI9341 |
| 12 | LCD SCLK | ILI9341 |
| 10 | LCD CS | ILI9341 |
| 9 | LCD DC | ILI9341 |
| 14 | LCD RST | ILI9341 |
| 15 | LCD Backlight | PWM |
| **Encoder:** | | |
| 4 | Encoder A (CLK) | –†–æ—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π |
| 5 | Encoder B (DT) | –†–æ—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π |
| 6 | Encoder SW | –ö–Ω–æ–ø–∫–∞ |

---

## üíª –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –æ—Ç ROOT

```c
void display_request_all_nodes_data(void) {
    char json_buf[256];
    
    // –°–æ–∑–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å
    mesh_protocol_create_request("display_001", "all_nodes_data", 
                                  json_buf, sizeof(json_buf));
    
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ ROOT
    mesh_manager_send_to_root((uint8_t*)json_buf, strlen(json_buf));
}

void on_root_response(const char *json_data) {
    mesh_message_t msg;
    if (!mesh_protocol_parse(json_data, &msg)) return;
    
    // –û–±–Ω–æ–≤–∏—Ç—å UI –¥–∞–Ω–Ω—ã–º–∏
    update_dashboard_ui(msg.data);
    
    mesh_protocol_free_message(&msg);
}
```

### LVGL —ç–∫—Ä–∞–Ω—ã

```c
// Dashboard - –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
void create_dashboard_screen(void) {
    lv_obj_t *scr = lv_obj_create(NULL);
    
    // –ö–∞—Ä—Ç–æ—á–∫–∏ —É–∑–ª–æ–≤
    create_node_card(scr, 10, 10, "pH/EC Zone 1", "6.5", "1.8");
    create_node_card(scr, 130, 10, "Climate", "24¬∞C", "65%");
    
    // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    lv_obj_t *btn_nodes = lv_btn_create(scr);
    lv_obj_set_pos(btn_nodes, 10, 200);
    lv_obj_add_event_cb(btn_nodes, on_nodes_clicked, LV_EVENT_CLICKED, NULL);
    
    lv_scr_load(scr);
}
```

### –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ hydro1.0

```c
// –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ hydro1.0:
// - lvgl_ui/
// - lcd_ili9341/
// - encoder/

// –ù–æ –∞–¥–∞–ø—Ç–∏—Ä—É–π –¥–ª—è mesh-—Å–µ—Ç–∏:
// - –ó–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ mesh (–Ω–µ –Ω–∞–ø—Ä—è–º—É—é –¥–∞—Ç—á–∏–∫–∏)
// - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ —Ç–∞–π–º–µ—Ä—É (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫)
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. `node_display/README.md` –∏ `doc/MESH_HYDRO_V2_FINAL_PLAN.md`

**–§–∞–∑–∞ 6 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (3-4 –¥–Ω—è)**

