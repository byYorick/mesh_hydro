# üîí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ NVS.

### –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

#### 1. **Emergency –ø–æ—Ä–æ–≥–∏ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ)**
- `ph_emergency_low` - –ö—Ä–∏—Ç–∏—á–Ω—ã–π –Ω–∏–∂–Ω–∏–π pH (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5.5)
- `ph_emergency_high` - –ö—Ä–∏—Ç–∏—á–Ω—ã–π –≤–µ—Ä—Ö–Ω–∏–π pH (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7.5)  
- `ec_emergency_high` - –ö—Ä–∏—Ç–∏—á–Ω—ã–π –≤–µ—Ä—Ö–Ω–∏–π EC (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3.0)

#### 2. **Safety –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
- `max_pump_time_ms` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –Ω–∞—Å–æ—Å–∞ (–º—Å)
- `cooldown_ms` - –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –º–µ–∂–¥—É –≤–∫–ª—é—á–µ–Ω–∏—è–º–∏ (–º—Å)
- `max_daily_volume_ml` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–æ–π –æ–±—ä–µ–º (–º–ª)

## üéØ –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### NODE pH:
```json
{
  "ph_emergency_low": 5.5,
  "ph_emergency_high": 7.5,
  "max_pump_time_ms": 10000,
  "cooldown_ms": 60000,
  "max_daily_volume_ml": 1000
}
```

### NODE EC:
```json
{
  "ec_emergency_high": 3.0,
  "max_pump_time_ms": 10000,
  "cooldown_ms": 60000,
  "max_daily_volume_ml": 1000
}
```

### NODE pH/EC:
```json
{
  "ph_emergency_low": 5.5,
  "ph_emergency_high": 7.5,
  "ec_emergency_high": 3.0,
  "max_pump_time_ms": 10000,
  "cooldown_ms": 60000,
  "max_daily_volume_ml": 1000
}
```

## üì° –£–¥–∞–ª–µ–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ö–æ–º–∞–Ω–¥–∞ —á–µ—Ä–µ–∑ MQTT:
```json
{
  "type": "command",
  "node_id": "ph_001",
  "command": "update_safety_config",
  "params": {
    "max_pump_time_ms": 15000,
    "cooldown_ms": 90000,
    "max_daily_volume_ml": 1500,
    "ph_emergency_low": 5.0,
    "ph_emergency_high": 8.0
  }
}
```

### –ö–æ–º–∞–Ω–¥–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ —É–∑–µ–ª pH/EC
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
4. –ò–∑–º–µ–Ω–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
5. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `common/node_config/node_config.h` - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- `common/node_config/node_config.c` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- `node_ph/components/ph_manager/ph_manager.c` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ—Ä–æ–≥–æ–≤
- `node_ec/components/ec_manager/ec_manager.c` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ—Ä–æ–≥–æ–≤  
- `node_ph_ec/components/ph_ec_manager/ph_ec_manager.c` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ—Ä–æ–≥–æ–≤

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:
1. **Emergency –ø—Ä–æ–≤–µ—Ä–∫–∞** —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ –≤–º–µ—Å—Ç–æ —Ä–∞–±–æ—á–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
2. **Safety –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ pump_controller
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** –≤ NVS –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
4. **–£–¥–∞–ª–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
```bash
# –ü–æ—Å–ª–µ –ø—Ä–æ—à–∏–≤–∫–∏ –Ω–æ–¥—ã
idf.py monitor
# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏ —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
```

### 2. –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```bash
# –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ MQTT
mosquitto_pub -h 192.168.0.167 -t "hydro/command/ph_001" -m @test_safety_config.json
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ emergency –ø–æ—Ä–æ–≥–æ–≤:
```bash
# –°–∏–º—É–ª—è—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ pH (–≤ –∫–æ–¥–µ)
s_current_ph = 4.0f; // –ù–∏–∂–µ ph_emergency_low
# –î–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å emergency stop
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Emergency –ø–æ—Ä–æ–≥–∏** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∂–µ —Ä–∞–±–æ—á–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
2. **Safety –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –≤–ª–∏—è—é—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
3. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** - –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã
4. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ NVS

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å —É–¥–∞–ª–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∏ –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ NVS –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–æ–¥!
