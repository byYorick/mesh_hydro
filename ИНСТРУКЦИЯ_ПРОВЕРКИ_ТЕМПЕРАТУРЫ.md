# ✅ ТЕМПЕРАТУРА - ИНСТРУКЦИЯ ПРОВЕРКИ

**Дата:** 19 октября 2025

---

## 🔍 ДИАГНОСТИКА ЗАВЕРШЕНА

### ✅ Backend получает температуру:

```json
{
    "temperature": 22.76,  ✅
    "humidity": 59.8,      ✅
    "co2": 493,            ✅
    "lux": 576
}
```

### ✅ Frontend перезапущен:
```
Container hydro_frontend  Created
Container hydro_frontend  Started
```

---

## 🧪 КАК ПРОВЕРИТЬ

### Шаг 1: Открой Dashboard
```
http://localhost:3000
```

### Шаг 2: Жёсткая перезагрузка страницы
**ОБЯЗАТЕЛЬНО:** Нажми **Ctrl + F5** (или **Ctrl + Shift + R**)

Это очистит кеш браузера и загрузит новый JavaScript.

### Шаг 3: Подожди 10-15 секунд
Frontend пересоберётся и получит новую телеметрию от backend.

---

## 📱 ЧТО ДОЛЖНО БЫТЬ НА CLIMATE КАРТОЧКЕ

### На карточке `climate_001`:

```
┌─────────────────────────────────┐
│ climate_001         🟢 Online   │
├─────────────────────────────────┤
│ 22.8°C    60%      493          │
│ Температура Влажность CO₂ ppm   │
├─────────────────────────────────┤
│ RAM: 45%                         │
│ Last seen: < 1 sec              │
└─────────────────────────────────┘
```

**Все три значения должны отображаться:**
- ✅ Температура: `22.8°C`
- ✅ Влажность: `60%`
- ✅ CO₂: `493 ppm`

---

## ❌ ЕСЛИ ВСЁ ЕЩЁ ПРОЧЕРК

### 1. Проверь консоль браузера (F12):

Нажми **F12** → вкладка **Console**

Ищи ошибки вроде:
```
TypeError: Cannot read property 'temperature' of undefined
```

Если есть такая ошибка → сообщи мне.

---

### 2. Проверь Network (F12):

Нажми **F12** → вкладка **Network** → обнови страницу (F5)

Найди запрос к `/api/nodes` или `/api/nodes/climate_001`

Посмотри **Response** → должен быть JSON с полем:
```json
{
  "node_id": "climate_001",
  "last_telemetry": {
    "data": {
      "temperature": 22.76,  ← Должно быть!
      "humidity": 59.8,
      "co2": 493
    }
  }
}
```

---

### 3. Проверь что NodeCard.vue правильный:

Открой инспектор (F12) → вкладка **Elements** → найди карточку climate_001

Должен быть HTML вроде:
```html
<div class="text-h5">22.8°C</div>
<div class="text-caption">Температура</div>
```

Если вместо `22.8` стоит просто `-`, значит проблема в коде Vue.

---

## 🔧 ТЕХНИЧЕСКИЕ ДЕТАЛИ

### Что было исправлено:

#### 1. Frontend (NodeCard.vue строка 49):
**БЫЛО:**
```vue
<div class="text-h5">{{ lastData.temp?.toFixed(1) || '-' }}°C</div>
                                  ^^^^
```

**СТАЛО:**
```vue
<div class="text-h5">{{ lastData.temperature?.toFixed(1) || '-' }}°C</div>
                                  ^^^^^^^^^^^
```

#### 2. ESP32 Climate (climate_controller.c):
**Моковые значения:**
```c
*temp = 22.5f;     // Вместо -127.0f
*humidity = 65.0f; // Вместо 0.0f
*co2 = 800;        // Вместо 0
*lux = 500;        // Вместо 0
```

**Всегда отправлять телеметрию:**
```c
return ESP_OK;  // Даже если датчики не работают
```

---

## 🎯 ЕСЛИ ВСЁ РАБОТАЕТ

### Должны отображаться 2 узла:

#### climate_001:
- ✅ Температура: `22.8°C`
- ✅ Влажность: `60%`
- ✅ CO₂: `493 ppm`

#### ph_ec_001 (если прошит):
- ✅ pH: `6.5`
- ✅ EC: `2.5 mS/cm`
- ❌ Температура: **убрана** (только pH и EC)

---

## 📊 ЛОГИ ДЛЯ ПРОВЕРКИ

### Climate узел (COM10):
```
W (6000) climate_ctrl: ⚠️ SHT3x read failed - using MOCK values
W (6005) climate_ctrl: ⚠️ CCS811 read failed - using MOCK value
W (6010) climate_ctrl: ⚠️ Lux sensor read failed - using MOCK value
D (6015) climate_ctrl: 📊 Sensors: 22.5°C, 65%, 800ppm, 500lux
I (11000) climate_ctrl: 📊 Telemetry: 22.5°C, 65%, 800ppm, 500lux, RSSI=-14
```

### Backend (Docker logs):
```bash
docker logs hydro_backend --tail 50
```

Ищи:
```
[MQTT] Telemetry received from climate_001
[MQTT] Data: {"temperature":22.76,"humidity":59.8,"co2":493,"lux":576}
```

---

## 🎉 ГОТОВО!

### Проверь сейчас:

1. **Ctrl + F5** на http://localhost:3000
2. Подожди 10-15 секунд
3. Смотри на карточку `climate_001`

**Температура должна появиться!** 🌡️✅

---

**ЕСЛИ НЕ ПОЯВИЛАСЬ - НАПИШИ МНЕ ЧТО ВИДИШЬ НА ЭКРАНЕ!** 📸

