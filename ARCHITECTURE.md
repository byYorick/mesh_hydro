# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Mesh Hydro System V2

## –¢–æ–ø–æ–ª–æ–≥–∏—è —Å–µ—Ç–∏

```
[–°–ï–†–í–ï–†] <--MQTT/WiFi--> [ROOT NODE] <--ESP-WIFI-MESH--> [–í—Å–µ NODE —É–∑–ª—ã]
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. ROOT NODE (ESP32-S3 #1)
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä mesh-—Å–µ—Ç–∏
- MQTT –∫–ª–∏–µ–Ω—Ç (—Å–≤—è–∑—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º)
- Node Registry (—É—á–µ—Ç –≤—Å–µ—Ö —É–∑–ª–æ–≤)
- Data Router (–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
- –†–µ–∑–µ—Ä–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–ª–∏–º–∞—Ç–∞

### 2. NODE Display (ESP32-S3 #2)
- TFT –¥–∏—Å–ø–ª–µ–π 240x320 (ILI9341)
- LVGL UI
- –†–æ—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä
- –ü–æ–∫–∞–∑ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —É–∑–ª–æ–≤

### 3. NODE pH/EC (ESP32-S3 #3+)
- –î–∞—Ç—á–∏–∫–∏ pH/EC (I2C)
- 5 –Ω–∞—Å–æ—Å–æ–≤ (pH UP/DOWN, EC A/B/C)
- OLED –¥–∏—Å–ø–ª–µ–π 128x64 (SSD1306)
- –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏
- PID –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä

### 4. NODE Climate (ESP32)
- SHT3x (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å)
- CCS811 (CO2)
- Trema Lux (–æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å)
- –¢–æ–ª—å–∫–æ –¥–∞—Ç—á–∏–∫–∏, –±–µ–∑ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

### 5. NODE Relay (ESP32)
- –õ–∏–Ω–µ–π–Ω—ã–µ –∞–∫—Ç—É–∞—Ç–æ—Ä—ã —Ñ–æ—Ä—Ç–æ—á–µ–∫ (2 —à—Ç)
- –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä
- LED —Å–≤–µ—Ç —Å PWM –¥–∏–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### 6. NODE Water (ESP32-C3)
- –ù–∞—Å–æ—Å—ã –ø–æ–¥–∞—á–∏/—Å–ª–∏–≤–∞
- –°–æ–ª–µ–Ω–æ–∏–¥–Ω—ã–µ –∫–ª–∞–ø–∞–Ω—ã (3 –∑–æ–Ω—ã)
- –î–∞—Ç—á–∏–∫ —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã

### 7. –°–µ—Ä–≤–µ—Ä
- **Backend:** Laravel 11 + PostgreSQL 15
- **Frontend:** Vue.js 3 + Vuetify 3
- **MQTT:** Mosquitto broker
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** Telegram Bot + SMS Gateway

## –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–Ω–∞

–§–æ—Ä–º–∞—Ç: JSON —á–µ—Ä–µ–∑ ESP-WIFI-MESH

–¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π:
- `telemetry` - —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è (NODE ‚Üí ROOT ‚Üí MQTT ‚Üí Server)
- `command` - –∫–æ–º–∞–Ω–¥—ã (Server ‚Üí MQTT ‚Üí ROOT ‚Üí NODE)
- `config` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Server ‚Üí NODE)
- `event` - —Å–æ–±—ã—Ç–∏—è (NODE ‚Üí Server)
- `heartbeat` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ (–∫–∞–∂–¥—ã–µ 10 —Å–µ–∫)

–°–º. `doc/MESH_PROTOCOL.md` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- WPA2 –¥–ª—è mesh-—Å–µ—Ç–∏
- Laravel Sanctum –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –≤ NVS
- Watchdog —Ç–∞–π–º–µ—Ä—ã –Ω–∞ –≤—Å–µ—Ö —É–∑–ª–∞—Ö

## –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

- **NODE pH/EC:** –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ —Å ROOT
- **ROOT:** –†–µ–∑–µ—Ä–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–ª–∏–º–∞—Ç–∞ –µ—Å–ª–∏ NODE Climate offline
- **Mesh:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É–∑–ª–æ–≤
- **OTA:** Dual partition —Å rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ

---

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `doc/MESH_HYDRO_V2_FINAL_PLAN.md`

