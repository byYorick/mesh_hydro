# NODE EC - Autonomous EC Control Node

**ESP32-C3** - –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —É–∑–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è EC (—ç–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å—é)

---

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–£–∑–µ–ª —Å–∏—Å—Ç–µ–º—ã Mesh Hydro –¥–ª—è:
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ EC –≤ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω–æ–º —Ä–∞—Å—Ç–≤–æ—Ä–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ 3 –ø–µ—Ä–∏—Å—Ç–∞–ª—å—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞—Å–æ—Å–∞ (A/B/C)
- PID —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ê–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ —Å ROOT
- Emergency protection –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö

---

## üîå –†–∞—Å–ø–∏–Ω–æ–≤–∫–∞ ESP32-C3

| GPIO | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|------|------------|------------|
| **I2C —à–∏–Ω–∞:** | | |
| 8 | I2C SDA | Data (EC –¥–∞—Ç—á–∏–∫ + OLED) |
| 9 | I2C SCL | Clock (100 kHz) |
| **–ù–∞—Å–æ—Å—ã:** | | |
| 2 | Pump EC A | GPIO HIGH = –≤–∫–ª |
| 3 | Pump EC B | GPIO HIGH = –≤–∫–ª |
| 4 | Pump EC C | GPIO HIGH = –≤–∫–ª |
| **–ò–Ω–¥–∏–∫–∞—Ü–∏—è:** | | |
| 5 | LED Status | RGB –∏–ª–∏ –æ–±—ã—á–Ω—ã–π LED |
| 6 | Buzzer | 3.3V –∞–∫—Ç–∏–≤–Ω—ã–π |

---

## üì¶ I2C –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | –ê–¥—Ä–µ—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-------|----------|
| **Trema EC** | 0x64 | –î–∞—Ç—á–∏–∫ EC (0-5.0 mS/cm) |
| **OLED SSD1306** | 0x3C | –î–∏—Å–ø–ª–µ–π 128x64 |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. WiFi –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `sdkconfig.defaults`:
```
CONFIG_ESP_WIFI_SSID="YourWiFi"
CONFIG_ESP_WIFI_PASSWORD="YourPassword"
```

### 2. –°–±–æ—Ä–∫–∞

```bash
cd node_ec
idf.py set-target esp32c3
idf.py build
```

### 3. –ü—Ä–æ—à–∏–≤–∫–∞

```bash
idf.py -p COMX flash monitor
```

---

## üìä –î–µ—Ñ–æ–ª—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```c
EC target: 2.5 (–¥–∏–∞–ø–∞–∑–æ–Ω 1.5-4.0 mS/cm)

PID –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ):
  EC A/B/C: Kp=0.8, Ki=0.02, Kd=0.2
```

---

## üì° Mesh –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

### Discovery:
```json
{
  "type": "discovery",
  "node_id": "ec_xxx",
  "node_type": "ec",
  "actuators": ["pump_ec_a", "pump_ec_b", "pump_ec_c"],
  "sensors": ["ec"]
}
```

### Telemetry:
```json
{
  "type": "telemetry",
  "data": {
    "ec": 2.3,
    "pump_ec_a_ml": 250.5,
    "pump_ec_b_ml": 245.2,
    "pump_ec_c_ml": 50.1
  }
}
```

---

**NODE EC - –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —É–∑–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è EC** üõ°Ô∏è

