# üîÑ –ö–ê–ö –û–¢–ü–†–ê–í–ò–¢–¨ DISCOVERY –°–ù–û–í–ê

**–ü—Ä–æ–±–ª–µ–º–∞:** MAC –∞–¥—Ä–µ—Å –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ Discovery –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ backend.

---

## üéØ –†–ï–®–ï–ù–ò–Ø (–Ω–∞ –≤—ã–±–æ—Ä)

### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —É–∑–µ–ª (—Å–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ)

**–î–ª—è climate_001 (COM10):**
1. –û—Ç–∫–ª—é—á–∏ USB –∫–∞–±–µ–ª—å
2. –ü–æ–¥–æ–∂–¥–∏ 3 —Å–µ–∫—É–Ω–¥—ã
3. –ü–æ–¥–∫–ª—é—á–∏ USB –∫–∞–±–µ–ª—å –æ–±—Ä–∞—Ç–Ω–æ
4. –£–∑–µ–ª –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç Discovery —Å MAC –∞–¥—Ä–µ—Å–æ–º
5. –ü–æ–¥–æ–∂–¥–∏ 15 —Å–µ–∫—É–Ω–¥
6. –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É Dashboard

**–û–∂–∏–¥–∞–µ–º—ã–π –ª–æ–≥:**
```
I (11420) climate_ctrl: üîç Discovery sent: climate_001 (RSSI=-45)
```

Backend –ø–æ–ª—É—á–∏—Ç Discovery —Å MAC –∞–¥—Ä–µ—Å–æ–º –∏ –æ–±–Ω–æ–≤–∏—Ç –ë–î.

---

### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ—à–∏—Ç—å —É–∑–µ–ª –∑–∞–Ω–æ–≤–æ

```batch
tools\flash_climate.bat
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —É–∑–µ–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç Discovery.

---

### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 3: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É Discovery (–¥–æ–ª–≥–æ)

**–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ ESP32:**

–í `node_climate/components/climate_controller/climate_controller.c`:

```c
// –í main_task, –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ telemetry:
if ((iteration % 60) == 0) {  // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
    send_discovery();
}
```

**–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø—Ä–æ—à–∏—Ç—å:**
```batch
cd node_climate
C:\Espressif\idf_cmd_init.bat esp-idf-1dcc643656a1439837fdf6ab63363005
idf.py build
idf.py -p COM10 flash
```

---

## üß™ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ò

### 1. –ü—Ä–æ–≤–µ—Ä—å –ë–î:

```bash
docker exec hydro_backend php artisan tinker --execute="echo json_encode(App\Models\Node::where('node_id', 'climate_001')->first()->only(['node_id', 'mac_address']), JSON_PRETTY_PRINT);"
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```json
{
    "node_id": "climate_001",
    "mac_address": "00:4B:12:37:D5:A4"  ‚Üê –î–û–õ–ñ–ï–ù –ü–û–Ø–í–ò–¢–¨–°–Ø!
}
```

---

### 2. –ü—Ä–æ–≤–µ—Ä—å Dashboard:

–û—Ç–∫—Ä–æ–π –¥–µ—Ç–∞–ª–∏ —É–∑–ª–∞ climate_001 ‚Üí –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É–∑–ª–∞

**–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:**
```
üîå MAC –∞–¥—Ä–µ—Å
   00:4B:12:37:D5:A4
```

---

## üìã –°–¢–ê–¢–£–° –°–ï–ô–ß–ê–°

### –í –ë–î –µ—Å—Ç—å MAC:
- ‚úÖ root_98a316f5fde8: `98:A3:16:F5:FD:E8`

### –ù–µ—Ç MAC:
- ‚ùå climate_001: `null`
- ‚ùå ph_ec_3cfd01: `null`

---

## üöÄ –°–ê–ú–û–ï –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï

**–ü–ï–†–ï–ó–ê–ì–†–£–ó–ò –£–ó–õ–´:**

1. **climate_001 (COM10):** –û—Ç–∫–ª—é—á–∏/–ø–æ–¥–∫–ª—é—á–∏ USB
2. **ph_ec —É–∑–µ–ª (COM9):** –û—Ç–∫–ª—é—á–∏/–ø–æ–¥–∫–ª—é—á–∏ USB
3. –ü–æ–¥–æ–∂–¥–∏ 15 —Å–µ–∫—É–Ω–¥
4. –û–±–Ω–æ–≤–∏ Dashboard

**MAC –∞–¥—Ä–µ—Å–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è!** üîå‚úÖ

