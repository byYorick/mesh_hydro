# ‚ö° –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ GPIO –¥–ª—è node_ph

**–î–∞—Ç–∞:** 22 –æ–∫—Ç—è–±—Ä—è 2025

---

## ‚úÖ GPIO –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Ä–∞—Å–ø–∞–π–∫—É

### –ë—ã–ª–æ (–ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏):
```c
GPIO 1  = Pump 0 (pH UP)
GPIO 2  = Pump 1 (pH DOWN)
```

### –°—Ç–∞–ª–æ (—Ä–µ–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç–∞ ESP32):
```c
GPIO 12 = Pump 0 (pH UP)
GPIO 13 = Pump 1 (pH DOWN)
```

---

## üìù –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. ‚úÖ `node_ph/components/pump_controller/pump_controller.c`
   ```c
   static const int PUMP_GPIO[PUMP_MAX] = {12, 13};
   ```

2. ‚úÖ `node_ph/main/app_main.c`
   ```c
   ESP_LOGI(TAG, "  - 2 pumps ready (GPIO 12,13 - pH UP/DOWN)");
   ```

3. ‚úÖ `node_ph/QUICK_TEST_GUIDE.md` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

4. ‚úÖ `node_ph/GPIO_CONFIG.md` - —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üîß –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ESP32   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚îú‚îÄ GPIO 12 ‚Üí MOSFET ‚Üí Pump pH UP (12V)
      ‚îÇ              ‚Üì
      ‚îÇ         –ü–∏—Ç–∞–Ω–∏–µ 12V
      ‚îÇ
      ‚îî‚îÄ GPIO 13 ‚Üí MOSFET ‚Üí Pump pH DOWN (12V)
                     ‚Üì
                –ü–∏—Ç–∞–Ω–∏–µ 12V
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ö–µ–º–∞ —Å MOSFET:

```
ESP32 GPIO 12 (3.3V)
     ‚îÇ
     ‚îú‚îÄ 10kŒ© ‚Üí GND (pull-down)
     ‚îÇ
     ‚îî‚îÄ MOSFET Gate (IRLZ44N)
           ‚îÇ
           ‚îú‚îÄ Drain ‚Üí Pump - (–º–∏–Ω—É—Å)
           ‚îî‚îÄ Source ‚Üí GND

Pump + (–ø–ª—é—Å) ‚Üí 12V –ø–∏—Ç–∞–Ω–∏–µ
```

---

## üß™ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç

### 1. –¢–µ—Å—Ç LED:
```
GPIO 12 ‚Üí LED + —Ä–µ–∑–∏—Å—Ç–æ—Ä 220Œ© ‚Üí GND
GPIO 13 ‚Üí LED + —Ä–µ–∑–∏—Å—Ç–æ—Ä 220Œ© ‚Üí GND
```

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```
http://192.168.0.167:3000
‚Üí –ù–∞–π—Ç–∏ —É–∑–µ–ª pH
‚Üí Pump 0 ‚Üí 2 —Å–µ–∫—É–Ω–¥—ã ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å
‚Üí LED –Ω–∞ GPIO 12 –∑–∞–≥–æ—Ä–∏—Ç—Å—è! ‚úÖ
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª–æ–≥–∞—Ö:
```bash
cd node_ph
idf.py monitor
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
I (93) ph_node: [Step 5/8] Pumps init (2x PWM)...
I (95) pump_ctrl: Pump 0 initialized (GPIO 12)
I (96) pump_ctrl: Pump 1 initialized (GPIO 13)
I (97) pump_ctrl: Pump controller ready (pH UP/DOWN)
I (98) ph_node:   - 2 pumps ready (GPIO 12,13 - pH UP/DOWN)
```

---

## üìã I2C –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã)

```c
GPIO 9  = SCL (I2C Clock)
GPIO 8  = SDA (I2C Data)
```

**–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:**
- Trema pH (0x0A) - –¥–∞—Ç—á–∏–∫ pH
- OLED SSD1306 (0x3C) - –¥–∏—Å–ø–ª–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

### GPIO 12 Bootloader warning:
GPIO 12 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è Flash (3.3V vs 1.8V).

**–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π:**
- –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ GPIO 12 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å LOW
- –ò–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –¥—Ä—É–≥–∏–µ GPIO (–Ω–∞–ø—Ä–∏–º–µ—Ä, 25, 26)

**–î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞**, —Ç–∞–∫ –∫–∞–∫:
- –ù–∞—Å–æ—Å—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω—ã (GPIO LOW)
- PWM –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0% (LOW)

---

## üöÄ –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –ø—Ä–æ—à–∏–≤–∫–∞

```bash
cd node_ph
rm -rf build  # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π —Å–±–æ—Ä–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
idf.py build
idf.py flash monitor
```

**–ü–æ—Å–ª–µ –ø—Ä–æ—à–∏–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```
I pump_ctrl: Pump 0 initialized (GPIO 12)  ‚úÖ
I pump_ctrl: Pump 1 initialized (GPIO 13)  ‚úÖ
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å node_ph –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **GPIO 12 –∏ 13** –¥–ª—è –Ω–∞—Å–æ—Å–æ–≤.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ–¥–∫–ª—é—á–∏—Ç–µ LED –∫ GPIO 12 –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å!

