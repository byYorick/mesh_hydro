# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ popup —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è —Å–æ–±—ã—Ç–∏–π

## ‚úÖ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ:

1. **Frontend –æ–±–Ω–æ–≤–ª–µ–Ω** —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π popup —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. **Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
3. **pH –Ω–æ–¥–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è** (–æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏)

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### –¢–µ—Å—Ç 1: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –Ω–∞—Å–æ—Å–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ frontend: `http://localhost`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —É–∑–ª—É `ph_3f0c00`
3. –†–∞—Å–∫—Ä–æ–π—Ç–µ **"–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏"**
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å"** –¥–ª—è –ª—é–±–æ–≥–æ –Ω–∞—Å–æ—Å–∞

**–û–∂–∏–¥–∞–µ–º—ã–µ popup (–≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É):**

```
‚ÑπÔ∏è [ph_3f0c00] –ù–∞—Å–æ—Å –∑–∞–ø—É—â–µ–Ω | –ù–∞—Å–æ—Å 0 | 5.0 –º–ª
```
‚Üì (—á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥)
```
‚úÖ [ph_3f0c00] –ù–∞—Å–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω | –ù–∞—Å–æ—Å 0 | 5.0 –º–ª | 5.2—Å
```

**–¶–≤–µ—Ç–∞:**
- –ü–µ—Ä–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: **–°–∏–Ω–µ–µ** (info, 4 —Å–µ–∫)
- –í—Ç–æ—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: **–ó–µ–ª—ë–Ω–æ–µ** (success, 3 —Å–µ–∫)

---

### –¢–µ—Å—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ frontend
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —É–∑–ª—É `ph_3f0c00`
3. –†–∞—Å–∫—Ä–æ–π—Ç–µ **"üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π"**
4. –ò–∑–º–µ–Ω–∏—Ç–µ **pH target** —Å `6.5` –Ω–∞ `6.8`
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"**

**–û–∂–∏–¥–∞–µ–º—ã–µ popup:**

```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```
‚Üì (—Å—Ä–∞–∑—É)
```
‚è±Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç —É–∑–ª–∞...
```
‚Üì (—á–µ—Ä–µ–∑ 2-5 —Å–µ–∫—É–Ω–¥, –∫–æ–≥–¥–∞ pH –Ω–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç)
```
‚úÖ [ph_3f0c00] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
```

**–¶–≤–µ—Ç–∞:**
- –ü–µ—Ä–≤–æ–µ: **–°–∏–Ω–µ–µ** (info)
- –í—Ç–æ—Ä–æ–µ: **–°–∏–Ω–µ–µ** —Å–æ spinner (info)
- –¢—Ä–µ—Ç—å–µ: **–ó–µ–ª—ë–Ω–æ–µ** (success)

---

### –¢–µ—Å—Ç 3: –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞—Å–æ—Å–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ frontend
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —É–∑–ª—É `ph_3f0c00`
3. –†–∞—Å–∫—Ä–æ–π—Ç–µ **"–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞—Å–æ—Å–æ–≤"**
4. –í–≤–µ–¥–∏—Ç–µ **10 –º–ª** –¥–ª—è **–ù–∞—Å–æ—Å–∞ 0**
5. –ù–∞–∂–º–∏—Ç–µ **"–ö–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å"**

**–û–∂–∏–¥–∞–µ–º—ã–µ popup:**

```
‚ÑπÔ∏è [ph_3f0c00] –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞—Å–æ—Å–∞ –Ω–∞—á–∞–ª–∞—Å—å | –ù–∞—Å–æ—Å 0
```
‚Üì (—á–µ—Ä–µ–∑ ~10 —Å–µ–∫—É–Ω–¥)
```
‚úÖ [ph_3f0c00] –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ | –ù–∞—Å–æ—Å 0 | 1.25 –º–ª/—Å
```

---

### –¢–µ—Å—Ç 4: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —É–∑–ª–∞

1. **–û—Ç–∫–ª—é—á–∏—Ç–µ pH –Ω–æ–¥—É** (–≤—ã–∫–ª—é—á–∏—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ USB)
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ ~30 —Å–µ–∫—É–Ω–¥

**–û–∂–∏–¥–∞–µ–º—ã–π popup:**

```
‚ö° –£–∑–µ–ª ph_3f0c00 –æ—Ñ–ª–∞–π–Ω
```

**–¶–≤–µ—Ç:** –û—Ä–∞–Ω–∂–µ–≤—ã–π (warning, 6 —Å–µ–∫)

3. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ pH –Ω–æ–¥—É –æ–±—Ä–∞—Ç–Ω–æ**
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ ~10 —Å–µ–∫—É–Ω–¥

**–û–∂–∏–¥–∞–µ–º—ã–π popup:**

```
‚úÖ [ph_3f0c00] –£–∑–µ–ª –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ç–∏
```

**–¶–≤–µ—Ç:** –ó–µ–ª—ë–Ω—ã–π (success, 3 —Å–µ–∫)

---

### –¢–µ—Å—Ç 5: PID –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ)

**–£—Å–ª–æ–≤–∏–µ:** pH –¥–æ–ª–∂–µ–Ω –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –Ω–∞ >0.2

1. –û—Ç–∫—Ä–æ–π—Ç–µ frontend
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É–∑–µ–ª `ph_3f0c00` –≤ **–∞–≤—Ç–æ–Ω–æ–º–Ω–æ–º —Ä–µ–∂–∏–º–µ**
3. –î–æ–∂–¥–∏—Ç–µ—Å—å PID –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –µ—Å–ª–∏ pH != target)

**–û–∂–∏–¥–∞–µ–º—ã–µ popup:**

```
‚ÑπÔ∏è [ph_3f0c00] PID –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–∞—Å–æ—Å 0 | 2.5 –º–ª
```

**–¶–≤–µ—Ç:** –°–∏–Ω–µ–µ (info, 4 —Å–µ–∫)

---

### –¢–µ—Å—Ç 6: Emergency Stop (—Å–∏–º—É–ª—è—Ü–∏—è)

**–î–ª—è —Ç–µ—Å—Ç–∞ –Ω—É–∂–Ω–æ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ pH.**

**–í–∞—Ä–∏–∞–Ω—Ç 1:** –í –∫–æ–¥–µ –Ω–æ–¥—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç—ã:
```c
// –í ph_manager.c
#define PH_EMERGENCY_LOW 6.9  // –í—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞
#define PH_EMERGENCY_HIGH 7.1
```

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é MQTT –∫–æ–º–∞–Ω–¥—É:
```bash
mosquitto_pub -h localhost -t "hydro/events" -m '{"node_id":"ph_3f0c00","level":"emergency","message":"EMERGENCY STOP activated","data":{}}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π popup:**

```
üö® [ph_3f0c00] EMERGENCY STOP activated
```

**–¶–≤–µ—Ç:** –ö—Ä–∞—Å–Ω—ã–π (error, 15 —Å–µ–∫) - **–æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ!**

---

## üé® –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ popup:

| –£—Ä–æ–≤–µ–Ω—å | –¶–≤–µ—Ç | –ò–∫–æ–Ω–∫–∞ | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|---------|------|--------|--------------|
| Emergency | üî¥ –ö—Ä–∞—Å–Ω—ã–π | üö® | 15 —Å–µ–∫ |
| Critical | üî¥ –ö—Ä–∞—Å–Ω—ã–π | ‚ö†Ô∏è | 10 —Å–µ–∫ |
| Error | üî¥ –ö—Ä–∞—Å–Ω—ã–π | ‚ùå | 8 —Å–µ–∫ |
| Warning | üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π | ‚ö° | 6 —Å–µ–∫ |
| Info | üîµ –°–∏–Ω–∏–π | ‚ÑπÔ∏è | 4 —Å–µ–∫ |
| Success | üü¢ –ó–µ–ª—ë–Ω—ã–π | ‚úÖ | 3 —Å–µ–∫ |

---

## üìä –ü—Ä–∏–º–µ—Ä—ã popup —Å–æ–æ–±—â–µ–Ω–∏–π:

### –ó–∞–ø—É—Å–∫ –Ω–∞—Å–æ—Å–∞:
```
‚ÑπÔ∏è [ph_3f0c00] –ù–∞—Å–æ—Å –∑–∞–ø—É—â–µ–Ω | –ù–∞—Å–æ—Å 0 | 5.0 –º–ª
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞:
```
‚úÖ [ph_3f0c00] –ù–∞—Å–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω | –ù–∞—Å–æ—Å 0 | 5.0 –º–ª | 5.2—Å
```

### –û—à–∏–±–∫–∞ –Ω–∞—Å–æ—Å–∞:
```
‚ùå [ph_3f0c00] –û—à–∏–±–∫–∞ –Ω–∞—Å–æ—Å–∞ | –ù–∞—Å–æ—Å 1
```

### –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞:
```
‚úÖ [ph_3f0c00] –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ | –ù–∞—Å–æ—Å 0 | 1.25 –º–ª/—Å
```

### PID –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ:
```
‚ÑπÔ∏è [ph_3f0c00] PID –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–∞—Å–æ—Å 0 | 2.5 –º–ª
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```
‚úÖ [ph_3f0c00] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
```

### –£–∑–µ–ª –æ—Ñ–ª–∞–π–Ω:
```
‚ö° –£–∑–µ–ª ph_3f0c00 –æ—Ñ–ª–∞–π–Ω
```

### –£–∑–µ–ª –æ–Ω–ª–∞–π–Ω:
```
‚úÖ [ph_3f0c00] –£–∑–µ–ª –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ç–∏
```

### Emergency:
```
üö® [ph_3f0c00] EMERGENCY STOP activated
```

---

## üîç –û—Ç–ª–∞–¥–∫–∞ (–µ—Å–ª–∏ popup –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è):

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

–û—Ç–∫—Ä–æ–π—Ç–µ **Developer Tools (F12)** ‚Üí **Console**

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
‚úÖ WebSocket connected
Subscribed to channel: hydro-system
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:

–í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –ø—Ä–∏ —Å–æ–±—ã—Ç–∏—è—Ö:
```
üîî New event: {level: 'info', message: '–ù–∞—Å–æ—Å –∑–∞–ø—É—â–µ–Ω', ...}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–æ–±—ã—Ç–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è:

–í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥:
```javascript
// –í App.vue
console.log('üîî New event:', data)
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Backend MQTT Listener:

```bash
cd c:\esp\hydro\mesh\mesh_hydro\server
docker-compose logs -f mqtt_listener | grep -E "event|Event"
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
[INFO] üîî New event: pump_start for ph_3f0c00
[INFO] üîî Broadcasting event via WebSocket
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 1. –î–æ–∂–¥–∞—Ç—å—Å—è —Å–±–æ—Ä–∫–∏ pH –Ω–æ–¥—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
cd c:\esp\hydro\mesh\mesh_hydro\node_ph
dir build\ph_node.bin
```

### 2. –ü—Ä–æ—à–∏—Ç—å pH –Ω–æ–¥—É:
```bash
cd c:\esp\hydro\mesh\mesh_hydro\node_ph
idf.py flash -p COM4 monitor
```

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤—ã—à–µ

### 4. –ù–∞—Å–ª–∞–¥–∏—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤—ã–º–∏ popup! üéâ

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã —Å–æ–±—ã—Ç–∏–π:

### –í `App.vue` (—Å—Ç—Ä–æ–∫–∞ ~432):
```javascript
const eventLevelMap = {
  'emergency': { type: 'error', icon: 'üö®', duration: 15000 },
  'critical': { type: 'error', icon: '‚ö†Ô∏è', duration: 10000 },
  // ... –∏–∑–º–µ–Ω–∏—Ç—å duration –ø–æ –≤–∫—É—Å—É
}
```

### –û—Ç–∫–ª—é—á–∏—Ç—å popup –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π:
```javascript
// –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å info —Å–æ–±—ã—Ç–∏—è
if (data.level === 'info') {
  return // –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
}
```

---

## ‚úÖ –°—Ç–∞—Ç—É—Å:

- [x] –°–∏—Å—Ç–µ–º–∞ popup —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [x] Frontend –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] pH –Ω–æ–¥–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è (–æ–∂–∏–¥–∞–Ω–∏–µ)
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ popup

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ –ø—Ä–æ—à–∏–≤–∫–∏ pH –Ω–æ–¥—ã!**

