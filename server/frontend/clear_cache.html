<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ - Mesh Hydro System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            background: #1976d2;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .button:hover {
            background: #1565c0;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background: #e3f2fd;
            border-left: 4px solid #1976d2;
        }
        .error {
            background: #ffebee;
            border-left-color: #f44336;
        }
        .success {
            background: #e8f5e8;
            border-left-color: #4caf50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –±—Ä–∞—É–∑–µ—Ä–∞</h1>
        <p>–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
        
        <div class="status" id="status">
            –ì–æ—Ç–æ–≤ –∫ –æ—á–∏—Å—Ç–∫–µ –∫—ç—à–∞...
        </div>
        
        <button class="button" onclick="clearCache()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
        <button class="button" onclick="hardReload()">üîÑ –ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</button>
        <button class="button" onclick="goToApp()">üöÄ –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é</button>
        
        <h3>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h3>
        <ol>
            <li>–ù–∞–∂–º–∏—Ç–µ "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"</li>
            <li>–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è, –Ω–∞–∂–º–∏—Ç–µ "–ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞"</li>
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) –∏ –≤–∫–ª—é—á–∏—Ç–µ "Disable cache" –≤ Network tab</li>
            <li>–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑</li>
        </ol>
        
        <h3>–ü—Ä–æ–≤–µ—Ä–∫–∞:</h3>
        <p>–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ—à–∏–±–∫–∏ <code>Cannot read properties of undefined (reading 'includes')</code> –∏—Å—á–µ–∑–ª–∏.</p>
    </div>

    <script>
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = 'status ' + type;
        }

        function clearCache() {
            updateStatus('–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞...', 'info');
            
            // –û—á–∏—Å—Ç–∫–∞ localStorage
            try {
                localStorage.clear();
                console.log('localStorage –æ—á–∏—â–µ–Ω');
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ localStorage:', e);
            }
            
            // –û—á–∏—Å—Ç–∫–∞ sessionStorage
            try {
                sessionStorage.clear();
                console.log('sessionStorage –æ—á–∏—â–µ–Ω');
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ sessionStorage:', e);
            }
            
            // –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —á–µ—Ä–µ–∑ Cache API
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    for (let name of names) {
                        caches.delete(name);
                    }
                    console.log('Cache API –æ—á–∏—â–µ–Ω');
                });
            }
            
            updateStatus('–ö—ç—à –æ—á–∏—â–µ–Ω! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É...', 'success');
            
            setTimeout(() => {
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –æ—á–∏—Å—Ç–∫–æ–π –∫—ç—à–∞
                window.location.href = '/?v=' + Date.now();
            }, 1000);
        }

        function hardReload() {
            updateStatus('–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∂–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞...', 'info');
            
            // –ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
            if (navigator.serviceWorker) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                    }
                });
            }
            
            setTimeout(() => {
                window.location.reload(true);
            }, 500);
        }

        function goToApp() {
            updateStatus('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é...', 'info');
            window.location.href = '/?v=' + Date.now();
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏
        window.addEventListener('load', function() {
            const currentTime = new Date().toLocaleString();
            updateStatus(`–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞: ${currentTime}. –ì–æ—Ç–æ–≤ –∫ –æ—á–∏—Å—Ç–∫–µ –∫—ç—à–∞.`, 'success');
        });
    </script>
</body>
</html>
